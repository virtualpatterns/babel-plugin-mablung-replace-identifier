{"version":3,"sources":["../../../source/test/library/visitor-single.test.js"],"names":["createRequire","CreateRequire","DefaultBabel","ModuleBabel","Test","ModuleInvalidImportTypeReplaceIdentifierError","InvalidImportTypeReplaceIdentifierError","Babel","Require","import","meta","url","beforeEach","test","context","codeIn","option","resolve","plugins","rule","replaceWith","code","actualCodeOut","transformAsync","expectedCodeOut","is","addImport","push","promise","throwsAsync"],"mappings":"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","sourcesContent":["import { createRequire as CreateRequire } from 'module'\nimport DefaultBabel, * as ModuleBabel from '@babel/core'\nimport Test from 'ava'\n\nimport ModuleInvalidImportTypeReplaceIdentifierError from '../../library/error/invalid-import-type-replace-identifier-error.cjs'\n\nconst { InvalidImportTypeReplaceIdentifierError } = ModuleInvalidImportTypeReplaceIdentifierError\nconst Babel = DefaultBabel || ModuleBabel\nconst Require = CreateRequire(import.meta.url)\n\nTest.beforeEach((test) => {\n\n  test.context.codeIn = 'console.log(__require.resolve(\\'./index.js\\'))'\n  test.context.option = { \n    'plugins': [ \n      [\n        Require.resolve('../../index.cjs'),\n        {\n          'rule': [\n            {\n              'searchFor': '__require',\n              'replaceWith': '...',\n              'parserOption': { \n                'plugins': [ 'importMeta' ], \n                'sourceType': 'module' \n              },\n              'addImport': []\n            }\n          ]\n        }      \n      ]\n    ]\n  }\n  \n})\n\nTest('rule.replaceWith = \\'createRequire(import.meta.url)\\'', async (test) => {\n\n  test.context.option.plugins[0][1].rule[0].replaceWith = 'createRequire(import.meta.url)'\n\n  let { code: actualCodeOut } = await Babel.transformAsync(test.context.codeIn, test.context.option)\n  let expectedCodeOut = 'console.log(createRequire(import.meta.url).resolve(\\'./index.js\\'));'\n\n  test.is(actualCodeOut, expectedCodeOut)\n\n})\n\nTest('addImport.type: \\'default\\'', async (test) => {\n\n  test.context.option.plugins[0][1].rule[0].replaceWith = '__importIdentifier(import.meta.url)'\n  test.context.option.plugins[0][1].rule[0].addImport.push({\n    'type': 'default',\n    'source': 'module',\n    'option': {\n      'nameHint': 'createRequire'\n    }\n  })\n\n  let { code: actualCodeOut } = await Babel.transformAsync(test.context.codeIn, test.context.option)\n  let expectedCodeOut = 'import _createRequire from \"module\";\\nconsole.log(_createRequire(import.meta.url).resolve(\\'./index.js\\'));'\n\n  test.is(actualCodeOut, expectedCodeOut)\n\n})\n\nTest('addImport.type: \\'named\\'', async (test) => {\n\n  test.context.option.plugins[0][1].rule[0].replaceWith = '__importIdentifier(import.meta.url)'\n  test.context.option.plugins[0][1].rule[0].addImport.push({\n    'type': 'named',\n    'name': 'createRequire',\n    'source': 'module'\n  })\n\n  let { code: actualCodeOut } = await Babel.transformAsync(test.context.codeIn, test.context.option)\n  let expectedCodeOut = 'import { createRequire as _createRequire } from \"module\";\\nconsole.log(_createRequire(import.meta.url).resolve(\\'./index.js\\'));'\n\n  test.is(actualCodeOut, expectedCodeOut)\n\n})\n\nTest('addImport.type: \\'namespace\\'', async (test) => {\n\n  test.context.option.plugins[0][1].rule[0].replaceWith = '__importIdentifier(import.meta.url)'\n  test.context.option.plugins[0][1].rule[0].addImport.push({\n    'type': 'namespace',\n    'source': 'module',\n    'option': {\n      'nameHint': 'createRequire'\n    }\n  })\n\n  let { code: actualCodeOut } = await Babel.transformAsync(test.context.codeIn, test.context.option)\n  let expectedCodeOut = 'import * as _createRequire from \"module\";\\nconsole.log(_createRequire(import.meta.url).resolve(\\'./index.js\\'));'\n\n  test.is(actualCodeOut, expectedCodeOut)\n\n})\n\nTest('addImport.type: \\'sideEffect\\'', async (test) => {\n\n  test.context.option.plugins[0][1].rule[0].replaceWith = '__importIdentifier(import.meta.url)'\n  test.context.option.plugins[0][1].rule[0].addImport.push({\n    'type': 'sideEffect',\n    'source': 'module'\n  })\n\n  let { code: actualCodeOut } = await Babel.transformAsync(test.context.codeIn, test.context.option)\n  let expectedCodeOut = 'import \"module\";\\nconsole.log(__importIdentifier(import.meta.url).resolve(\\'./index.js\\'));'\n\n  test.is(actualCodeOut, expectedCodeOut)\n\n})\n\nTest('addImport.type: invalid', async (test) => {\n\n  test.context.option.plugins[0][1].rule[0].replaceWith = '__importIdentifier(import.meta.url)'\n  test.context.option.plugins[0][1].rule[0].addImport.push({\n    'type': '_sideEffect',\n    'source': 'module'\n  })\n\n  let promise = Babel.transformAsync(test.context.codeIn, test.context.option)\n\n  await test.throwsAsync(promise, { 'instanceOf': InvalidImportTypeReplaceIdentifierError })\n\n})\n\n"],"file":"visitor-single.test.js"}